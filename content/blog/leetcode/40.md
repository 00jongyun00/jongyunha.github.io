---
title: Leetcode 40. Combination Sum II
date: 2022-12-16
description: "Advanced Combination solution"
tags: [Leetcode, Kotlin, Algorithm]
thumbnail: ""
---

Given a collection of candidate numbers (candidates) and a target number (target), find all unique combinations in candidates where the candidate numbers sum to target.

Each number in candidates may only be used once in the combination.

Note: The solution set must not contain duplicate combinations.
 
Example 1:

```
Input: candidates = [10,1,2,7,6,1,5], target = 8
Output: 
[
[1,1,6],
[1,2,5],
[1,7],
[2,6]
]
```

Example 2:
```
Input: candidates = [2,5,2,1,2], target = 5
Output: 
[
[1,2,2],
[5]
]
```

## Approach

해당 문제는 Leetcode 39 Combination sum 의 변형 문제입니다.
각 elements 를 한번만 사용하여 unique 한 combination(순열) 을 뽑아내는 문제입니다.
해당 문제는 각 elements 를 counting 하는 방법으로 접근하여 해결하였습니다.

```kotlin
fun combinationSum2(candidates: IntArray, target: Int): List<List<Int>> {
    val result = mutableListOf<List<Int>>()
    val map = mutableMapOf<Int, Int>()
    for (i in candidates.indices) {
        map[candidates[i]] = (map[candidates[i]] ?: 0) + 1
    }
    val candPairs = ArrayList<Pair<Int, Int>>(map.toList())

    fun backtrack(
        target: Int,
        start: Int,
        list: MutableList<Int>,
    ) {
        if (target == 0) result.add(list.toList())
        if (target < 0) return

        for (i in start until candPairs.size) {
            val (cand, cnt) = candPairs[i]
            if (cnt == 0) continue
            list.add(cand)
            candPairs[i] = Pair(cand, cnt - 1)
            backtrack(target - cand, i, list)
            list.removeAt(list.size - 1)
            candPairs[i] = Pair(cand, cnt)
        }
    }
    backtrack(target, 0, mutableListOf())
    return result
}
```
<br/>

- candPair 는 각 elements 에 대해 Pair type 으로 counting 한 변수입니다.
- target 은 recusive 를 종료하기 위한 조건 입니다.
- start 는 각 recusive stack frame 에서 candPairs 를 어떤 index 부터 시작할지 위한 parameter 입니다.
- 마지막으로 kotlin 의 parameter 는 모두 참조 이기 때문에 result.add 에서 toList() 로 copy 해서 넣어줍니다.